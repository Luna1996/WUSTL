(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     18040,        467]
NotebookOptionsPosition[     17044,        445]
NotebookOutlinePosition[     17385,        460]
CellTagsIndexPosition[     17342,        457]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"thin", "[", 
    RowBox[{"cc_", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"t1_:", 
        RowBox[{"{", 
         RowBox[{"Infinity", ",", "1"}], "}"}]}], ",", 
       RowBox[{"t2_:", 
        RowBox[{"{", 
         RowBox[{"Infinity", ",", "1"}], "}"}]}]}], "}"}]}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "M", ",", "C", ",", "I", ",", "E", ",", "k", ",", "t", ",", "q", ",", 
       "R"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"M", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "cc", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{"M", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"d", "-", "1"}], ",", "j"}], "]"}], "]"}], ",", "i"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "2", ",", 
          RowBox[{"Length", "[", "cc", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"cc", "[", 
            RowBox[{"[", "d", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"cc", "[", 
            RowBox[{"[", 
             RowBox[{"d", ",", "i"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
      ";", "\n", "\t\t", 
      RowBox[{"C", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "#", "]"}], "]"}], ")"}], "&"}], ",", 
         "cc"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"I", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"Infinity", ",", "cc", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"k", "=", "0"}], ";", "\n", "\t\t", 
      RowBox[{"Label", "[", "s", "]"}], ";", "\n", "\t\t", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"M", "[", 
              RowBox[{"[", 
               RowBox[{"d", ",", "i"}], "]"}], "]"}], "]"}], "\[Equal]", 
            "0"}], "&&", 
           RowBox[{
            RowBox[{"I", "[", 
             RowBox[{"[", 
              RowBox[{"d", ",", "i"}], "]"}], "]"}], "\[NotEqual]", 
            "Infinity"}]}], ",", 
          RowBox[{
           RowBox[{"I", "[", 
            RowBox[{"[", 
             RowBox[{"d", ",", "i"}], "]"}], "]"}], "=", "k"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", 
          RowBox[{"Length", "[", "cc", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"cc", "[", 
            RowBox[{"[", "d", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
      "\n", "\t\t", 
      RowBox[{"k", "++"}], ";", 
      RowBox[{"q", "=", 
       RowBox[{"{", 
        RowBox[{"Infinity", ",", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"t1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"t1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", "k"}]}], "]"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"t2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"t2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", "k"}]}], "]"}], ",", 
         "Infinity"}], "}"}]}], ";", "\n", "\t\t", 
      RowBox[{"E", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"Length", "[", "C", "]"}]}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"M", "[", 
             RowBox[{"[", 
              RowBox[{"d", ",", "i"}], "]"}], "]"}], "]"}], "\[Equal]", "1"}],
           ",", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"t", "=", 
            RowBox[{"M", "[", 
             RowBox[{"[", 
              RowBox[{"d", ",", "i", ",", "1"}], "]"}], "]"}]}], ";", "\n", 
           "\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"k", "-", 
                RowBox[{"I", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"d", "+", "1"}], ",", "t"}], "]"}], "]"}]}], 
               "\[LessEqual]", 
               RowBox[{"q", "[", 
                RowBox[{"[", 
                 RowBox[{"d", "+", "1"}], "]"}], "]"}]}], "&&", 
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"E", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", "+", "1"}], "]"}], "]"}], ",", "t"}], 
                "]"}]}]}], ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"E", "[", 
                 RowBox[{"[", "d", "]"}], "]"}], ",", "i"}], "]"}], ";", "\n",
               "\t\t\t\t", 
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"E", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", "+", "1"}], "]"}], "]"}], ",", "t"}], "]"}], 
              ";"}]}], "\n", "\t\t\t", "]"}]}]}], "]"}], ",", "\n", "\t\t", 
        RowBox[{"{", 
         RowBox[{"d", ",", 
          RowBox[{
           RowBox[{"Length", "[", "C", "]"}], "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"C", "[", 
            RowBox[{"[", "d", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
      "\n", "\t\t", 
      RowBox[{"Do", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"t", "=", 
             RowBox[{"E", "[", 
              RowBox[{"[", 
               RowBox[{"d", ",", "i"}], "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"d", ">", "1"}], ",", 
              RowBox[{
               RowBox[{"M", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"d", "-", "1"}], ",", 
                  RowBox[{"cc", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "t"}], "]"}], "]"}]}], "]"}], "]"}], 
               "=", 
               RowBox[{
                RowBox[{"M", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"d", "-", "1"}], ",", 
                   RowBox[{"cc", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "t"}], "]"}], "]"}]}], "]"}], "]"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"t", "\[Rule]", "Nothing"}], "}"}]}]}]}], "]"}]}], 
           ",", "\n", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"E", "[", 
               RowBox[{"[", "d", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
         "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"C", "[", 
           RowBox[{"[", "d", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"C", "[", 
            RowBox[{"[", "d", "]"}], "]"}], "/.", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#", "\[Rule]", "Nothing"}], "&"}], ")"}], ",", 
             RowBox[{"E", "[", 
              RowBox[{"[", "d", "]"}], "]"}]}], "]"}]}]}]}], ",", "\n", 
        "\t\t", 
        RowBox[{"{", 
         RowBox[{"d", ",", 
          RowBox[{"Length", "[", "E", "]"}]}], "}"}]}], "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "E", "]"}], ">", "0"}], ",", 
        RowBox[{"Goto", "[", "s", "]"}]}], "]"}], ";", "\n", "\t\t", 
      RowBox[{"R", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"cc", "[", 
          RowBox[{"[", 
           RowBox[{"d", ",", 
            RowBox[{"C", "[", 
             RowBox[{"[", "d", "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"d", ",", 
           RowBox[{"Length", "[", "C", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"t", "=", "1"}], ";", 
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{"[", 
            RowBox[{"d", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{"[", 
             RowBox[{"d", "+", "1"}], "]"}], "]"}], "/.", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"t", "++"}], ")"}]}], "&"}], ")"}], ",", 
             RowBox[{"C", "[", 
              RowBox[{"[", "d", "]"}], "]"}]}], "]"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"C", "-", "1"}], "]"}]}], "}"}]}], "]"}], ";", "\n", 
      "\t\t", "R"}]}], "\n", "\t", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7468860325616593`*^9, 3.746886068251855*^9}, {
   3.746887063972895*^9, 3.746887258531977*^9}, {3.7468874829934034`*^9, 
   3.7468874922929125`*^9}, {3.74688753844973*^9, 3.7468875493443766`*^9}, {
   3.7468876035021505`*^9, 3.7468876068243694`*^9}, {3.7468876379285374`*^9, 
   3.746887646706237*^9}, {3.746887683752514*^9, 3.7468876843804245`*^9}, {
   3.7468878442428007`*^9, 3.7468879048088975`*^9}, {3.7468879757166004`*^9, 
   3.7468879767021785`*^9}, {3.746888012487581*^9, 3.7468880733701267`*^9}, {
   3.7468881074627037`*^9, 3.7468881080132656`*^9}, {3.7468881388624983`*^9, 
   3.7468881465688543`*^9}, {3.7468889920632825`*^9, 3.746889035231037*^9}, {
   3.746889078319931*^9, 3.7468891900869985`*^9}, {3.7468892338176274`*^9, 
   3.74688935300336*^9}, {3.746889438998489*^9, 3.7468894529551353`*^9}, {
   3.746889610545068*^9, 3.7468896115623884`*^9}, {3.746889837914277*^9, 
   3.746889856924756*^9}, {3.7468899317124767`*^9, 3.746889953980024*^9}, 
   3.746890029754609*^9, {3.7468900742276893`*^9, 3.746890119032104*^9}, {
   3.7468902559856873`*^9, 3.746890348918132*^9}, {3.746890516831029*^9, 
   3.74689055312829*^9}, {3.74689097350225*^9, 3.746890981246309*^9}, {
   3.7468910187393847`*^9, 3.746891023883718*^9}, {3.7468913386463985`*^9, 
   3.746891362437272*^9}, {3.7468914374152384`*^9, 3.7468914616758647`*^9}, {
   3.7468914972026777`*^9, 3.7468914972874937`*^9}, {3.7468915291959944`*^9, 
   3.7468915362720475`*^9}, {3.746891609613982*^9, 3.746891644936641*^9}, {
   3.746891685432141*^9, 3.746891693957107*^9}, {3.746891746790085*^9, 
   3.7468918263322487`*^9}, {3.74689196738724*^9, 3.746891994698216*^9}, {
   3.746892146162709*^9, 3.746892171676529*^9}, {3.74689222023904*^9, 
   3.746892353746686*^9}, {3.746892396129148*^9, 3.7468923988065825`*^9}, {
   3.746892681517193*^9, 3.746892687195524*^9}, {3.746892963868308*^9, 
   3.746893017330844*^9}, 3.7468937696531067`*^9, {3.746893844211464*^9, 
   3.7468938505329876`*^9}, {3.7468939317088976`*^9, 
   3.7468940533531675`*^9}, {3.7468940857821884`*^9, 
   3.7468941262648444`*^9}, {3.74689416711526*^9, 3.7468944300306234`*^9}, {
   3.7468944745274167`*^9, 3.7468945033763866`*^9}, {3.7468945361107187`*^9, 
   3.7468947200560365`*^9}, {3.7468947627496696`*^9, 
   3.7468948312622085`*^9}, {3.746896512435536*^9, 3.7468965262674723`*^9}, {
   3.746896933865385*^9, 3.746896977700897*^9}, {3.7468971290132203`*^9, 
   3.7468971300151405`*^9}, {3.746897162632614*^9, 3.7468971635402937`*^9}, {
   3.7468976210444975`*^9, 
   3.746897743806548*^9}},ExpressionUUID->"070c9079-7d6b-4fa2-8463-\
78077c235831"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"arrC", "=", 
   RowBox[{"buildCC2D", "[", 
    RowBox[{"{", 
     RowBox[{"{", "1", "}"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{"showCC2D", "[", 
  RowBox[{
   RowBox[{"thin", "[", 
    RowBox[{"arrC", ",", 
     RowBox[{"{", "}"}]}], "]"}], ",", "arrC"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7468974124734073`*^9, 3.7468974506485643`*^9}, {
  3.7468975072640405`*^9, 3.7468975360494123`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"4c03c22e-57d8-4c14-a553-ef1b14c779a2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"True", "&"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"l", "=", 
   RowBox[{"Range", "[", "1000000", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", "1000000"}], ",", 
      RowBox[{"i", "++"}], ",", "True"}], "]"}], "//", "AbsoluteTiming"}], 
   ")"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{"True", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1000000"}], "}"}]}], "]"}], "//", 
    "AbsoluteTiming"}], ")"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Scan", "[", 
     RowBox[{"f", ",", "l"}], "]"}], "//", "AbsoluteTiming"}], ")"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"True", ",", "1000000"}], "]"}], ";"}], "//", 
    "AbsoluteTiming"}], ")"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"a", "=", "l"}], ";"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "True"}], ";"}], "//", 
    "AbsoluteTiming"}], ")"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7468884528237257`*^9, 3.7468886154389277`*^9}, {
   3.7468886604846563`*^9, 3.7468886670075808`*^9}, {3.74688879063557*^9, 
   3.7468888110895414`*^9}, {3.7468888520726566`*^9, 3.746888896735112*^9}, {
   3.746888944743396*^9, 3.746888977438961*^9}, {3.7468897434627347`*^9, 
   3.7468897600625935`*^9}, {3.7468898747542076`*^9, 3.7468899053228874`*^9}, 
   3.746890755618157*^9},ExpressionUUID->"c3521364-03c9-4258-a34c-\
4f8dcaa978fb"],

Cell[BoxData["0.45142524978247284`"], "Output",
 CellChangeTimes->{
  3.746888741451928*^9, 3.74688881489694*^9, {3.746888857881812*^9, 
   3.746888898270233*^9}, {3.746888956741147*^9, 3.746888980239403*^9}, 
   3.746889761339269*^9, 3.746889876954936*^9, 3.746889907034069*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"a0e1be18-1ce2-41bb-b0c3-e4a3c94df416"],

Cell[BoxData["0.05283120838630202`"], "Output",
 CellChangeTimes->{
  3.746888741451928*^9, 3.74688881489694*^9, {3.746888857881812*^9, 
   3.746888898270233*^9}, {3.746888956741147*^9, 3.746888980239403*^9}, 
   3.746889761339269*^9, 3.746889876954936*^9, 3.7468899070886583`*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"9438272c-8eef-4834-a2c3-c31f9601fa90"],

Cell[BoxData["0.23116375038017115`"], "Output",
 CellChangeTimes->{
  3.746888741451928*^9, 3.74688881489694*^9, {3.746888857881812*^9, 
   3.746888898270233*^9}, {3.746888956741147*^9, 3.746888980239403*^9}, 
   3.746889761339269*^9, 3.746889876954936*^9, 3.7468899073202643`*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"167e8fd1-658e-4b1e-94c9-d16c9c561523"],

Cell[BoxData["0.040312728604113654`"], "Output",
 CellChangeTimes->{
  3.746888741451928*^9, 3.74688881489694*^9, {3.746888857881812*^9, 
   3.746888898270233*^9}, {3.746888956741147*^9, 3.746888980239403*^9}, 
   3.746889761339269*^9, 3.746889876954936*^9, 3.7468899073738394`*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"f15e58ef-1316-4349-a211-b9f3ca42ba66"],

Cell[BoxData["0.024676663070995183`"], "Output",
 CellChangeTimes->{
  3.746888741451928*^9, 3.74688881489694*^9, {3.746888857881812*^9, 
   3.746888898270233*^9}, {3.746888956741147*^9, 3.746888980239403*^9}, 
   3.746889761339269*^9, 3.746889876954936*^9, 3.7468899074016085`*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"ebb6ae4c-643e-4d4e-a224-049dd93fa9f3"]
}, Open  ]]
},
WindowSize->{958, 988},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 12247, 311, 561, "Input",ExpressionUUID->"070c9079-7d6b-4fa2-8463-78077c235831"],
Cell[12808, 333, 514, 13, 48, "Input",ExpressionUUID->"4c03c22e-57d8-4c14-a553-ef1b14c779a2"],
Cell[CellGroupData[{
Cell[13347, 350, 1866, 57, 143, "Input",ExpressionUUID->"c3521364-03c9-4258-a34c-4f8dcaa978fb"],
Cell[15216, 409, 358, 5, 32, "Output",ExpressionUUID->"a0e1be18-1ce2-41bb-b0c3-e4a3c94df416"],
Cell[15577, 416, 360, 5, 32, "Output",ExpressionUUID->"9438272c-8eef-4834-a2c3-c31f9601fa90"],
Cell[15940, 423, 360, 5, 32, "Output",ExpressionUUID->"167e8fd1-658e-4b1e-94c9-d16c9c561523"],
Cell[16303, 430, 361, 5, 32, "Output",ExpressionUUID->"f15e58ef-1316-4349-a211-b9f3ca42ba66"],
Cell[16667, 437, 361, 5, 32, "Output",ExpressionUUID->"ebb6ae4c-643e-4d4e-a224-049dd93fa9f3"]
}, Open  ]]
}
]
*)

